<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="description" content="A REST service for LCBO store, product, and inventory data.">
  <title>Conventions</title>
  <link href="/stylesheets/all.css" rel="stylesheet" type="text/css" />
  <script src="/javascripts/all.js" type="text/javascript"></script>
</head>

  <body id="lcboapi_body" class="gs960">
    <div class="grid-header">
  <div class="constraint">
    <h1>
      <a href="/">
        <span>LCBO API</span>
      </a>
    </h1>
    <p>
      <a href="http://twitter.com/lcboapi">
        <span>Follow on Twitter</span>
      </a>
    </p>
  </div>
</div>

    <div class="grid-body">
      <div class="constraint">
        
<div class="cols-1-2 clear">
  <div class="col-1">
    <div class="side-title">
      <h1>
        <span>LCBO API </span>Documentation
      </h1>
    </div>
    <ul class="side-menu">
      <li class="side-menu-section">
  <ul class="side-menu-list">
      <li class="side-menu-item">
        <a href="/docs/about">
          About
        </a>
      </li>
      <li class="side-menu-item">
        <a href="/docs/conventions">
          Conventions
        </a>
      </li>
      <li class="side-menu-item">
        <a href="/docs/faq">
          FAQ
        </a>
      </li>
  </ul>
</li>

        <li class="side-menu-section">
    <div class="side-menu-section-caption">
      Dataset Endpoints
    </div>
  <ul class="side-menu-list">
      <li class="side-menu-item">
        <a href="/docs/datasets">
          Datasets
        </a>
      </li>
      <li class="side-menu-item">
        <a href="/docs/dataset">
          Dataset
        </a>
      </li>
      <li class="side-menu-item">
        <a href="/docs/latest-dataset">
          Latest Dataset
        </a>
      </li>
  </ul>
</li>

        <li class="side-menu-section">
    <div class="side-menu-section-caption">
      Product Endpoints
    </div>
  <ul class="side-menu-list">
      <li class="side-menu-item">
        <a href="/docs/products">
          Products
        </a>
      </li>
      <li class="side-menu-item">
        <a href="/docs/product">
          Product
        </a>
      </li>
      <li class="side-menu-item">
        <a href="/docs/products-at-store">
          Products at Store
        </a>
      </li>
  </ul>
</li>

        <li class="side-menu-section">
    <div class="side-menu-section-caption">
      Store Endpoints
    </div>
  <ul class="side-menu-list">
      <li class="side-menu-item">
        <a href="/docs/stores-with-product">
          Stores with Product
        </a>
      </li>
      <li class="side-menu-item">
        <a href="/docs/stores">
          Stores
        </a>
      </li>
      <li class="side-menu-item">
        <a href="/docs/store">
          Store
        </a>
      </li>
  </ul>
</li>

        <li class="side-menu-section">
    <div class="side-menu-section-caption">
      Inventory Endpoints
    </div>
  <ul class="side-menu-list">
      <li class="side-menu-item">
        <a href="/docs/inventories">
          Inventories
        </a>
      </li>
      <li class="side-menu-item">
        <a href="/docs/inventory">
          Inventory
        </a>
      </li>
      <li class="side-menu-item">
        <a href="/docs/product-inventories">
          Product Inventories
        </a>
      </li>
  </ul>
</li>

    </ul>
  </div>
  <div class="col-2">
      <div class="document-title">
        <h2>Conventions</h2>
      </div>
      <div class="document-body">
<h3 id="responses">Responses</h3>

<p>The default response format for the API is JSON. This means that you don't
need to specify JSON in an <code>Accept</code> header or as an extension (.json) if
that is the format you intend to request. Every response from the API is
wrapped in a "container" that in its most basic form looks like this:</p>

<pre><code>{
  "status": 200,
  "message": null,
  "result": ...
}
</code></pre>

<p>This allows the API to return meta information along with the data you are
requesting. For example, in the case of a
<a href="/docs/stores-with-product">Stores with Product</a> request the product object
is returned with list of stores so that your application does not need to
perform an additional request to obtain store information.</p>

<h3 id="json-p">JSON-P</h3>

<p>JSON-P stands for "JSON with padding" which is a very confusing way of
saying JSON wrapped in a Javascript function call; I like to think of it as
JSON-JS. It is used to circumvent browser security limitations when trying
to access resources via Javascript from a different host than the containing
page. That means you can use it to load LCBO API resources on a page that is
not hosted on lcboapi.com, such as your website!</p>

<p>One of the limitations to JSON-P is that the HTTP status can not be properly
set to an error level because the <code>&lt;script&gt;</code> element that is dynamically
written to the page will fail to load. Because of this all JSON-P requests
return a 200 HTTP status code, regardless of the actual status. However, the
<code>"status"</code> node in the response container always indicates the real status.</p>

<p>To use JSON-P simply provide a <code>callback</code> parameter to your query. For
example, to search products and return JSON-P you would request:</p>

<pre><code>/products?q=cider&amp;<em>callback=</em>setJSON
</code></pre>

<p>This will return the normal JSON response but wrap it in a function call:</p>

<pre><code><em>setJSON(</em>{"status":200, "message":null, "response": ...}<em>);</em>
</code></pre>

<p>You can optionally specify a <code>.js</code> file extension for the resource, but the
<code>Content-Type</code> header will always be set to <code>text/javascript</code> when returning
JSON-P. For example the following request URI is the same as the one above.</p>

<pre><code>/products<em>.js</em>?q=cider&amp;callback=setJSON
</code></pre>

<h3 id="pagination">Pagination</h3>

<p>When the API returns collections of items (stores, products, or inventories)
it will paginate the results. You can control the number of items per page
through the <code>per_page</code> parameter.</p>

<p>A typical pager object looks like this:</p>

<pre><code>{
  "records_per_page": 20,
  "total_record_count": 608,
  "current_page_record_count": 20,
  "is_first_page": false,
  "is_final_page": false,
  "current_page": 5,
  "current_page_path": "/stores?page=5",
  "next_page": 6,
  "next_page_path": "/stores?page=6",
  "previous_page": 4,
  "previous_page_path": "/stores?page=4",
  "final_page": 31,
  "final_page_path": "/stores?page=31"
}
</code></pre>

<p>It contains all of the information you need (and more) to navigate through
the pages in the result set.</p>

<h3 id="csv-and-tsv-responses">CSV and TSV Responses</h3>

<p>Many resources can be returned as CSV (comma separated values) or TSV
(tab separated values). These results can then be easily imported into
spreadsheet software such as Apple Numbers or Microsoft Excel. To return
a resource in CSV or TSV format simply append the <code>.csv</code> or <code>.tsv</code>
extension to the resource URI:</p>

<pre><code>/products<em>.csv</em>?order=price_in_cents.desc
</code></pre>

<h3 id="errors">Errors</h3>

<p>When an error occurs the response will look something like this:</p>

<pre><code>{
  "error": "bad_query_error",
  "message": "A value supplied for the order parameter (id.desk) is not valid. It contains an invalid sort order (desk) for (id) try using: id.desc or id.asc instead.",
  "result": null,
  "status": 400
}
</code></pre>

<p>Error messages are always as descriptive as possible; one of the design
goals for LCBO API is to make experiential learning (learning by trial and
error) as easy as possible. There are a few different types of errors:</p>

<ul>
  <li><code>no_results_error</code>: The geocoder returned no geometry for the geo query.</li>
  <li><code>over_limit_error</code>: The geocoder has reached its daily limit of requests.</li>
  <li><code>geocoder_error</code>: The geocoder can't geocode the query it was provided.</li>
  <li><code>not_found_error</code>: A resource was not found (404)</li>
  <li><code>bad_query_error</code>: One (or more) of the supplied query parameters is
wrong.</li>
  <li><code>jsonp_error</code>: Supplied callback is not a valid format, or JSON-P is not
being used correctly.</li>
</ul>

      </div>
  </div>
</div>

      </div>
    </div>
    <div class="grid-footer">
  <div class="constraint clear">
    <p class="footer-copyright">
      &copy; 2009&ndash;2014
      <a href="http://heycarsten.com">Carsten Nielsen</a>
      <br>
      <span>
        <span class="heart">&hearts;</span>
        Sponsored by
        <a href="http://unspace.ca">Unspace</a>
        <span class="heart">&hearts;</span>
      </span>
    </p>
    <p class="footer-disclaimer">
      LCBO API is <em>not</em> endorsed or supported by the
      <acronym title="Liquor Control Board of Ontario">LCBO</acronym>
    </p>
  </div>
</div>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8617929-2', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>
